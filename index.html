<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libpressio: LibPressio</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libpressio
   &#160;<span id="projectnumber">0.87.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">LibPressio </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="https://travis-ci.org/robertu94/libpressio"><img src="https://travis-ci.org/robertu94/libpressio.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a></p>
<p><em>the upstream version of this code is found at <a href="https://github.com/CODARcode/libpressio">at the CODARCode organization</a></em></p>
<p>Pressio is latin for compression. LibPressio is a C++ library with C compatible bindings to abstract between different lossless and lossy compressors and their configurations. It solves the problem of having to having to write separate application level code for each lossy compressor that is developed. Instead, users write application level code using LibPressio, and the library will make the correct underlying calls to the compressors. It provides interfaces to represent data, compressors settings, and compressors.</p>
<p>Documentation for the <code>master</code> branch can be <a href="https://robertu94.github.io/libpressio/">found here</a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Using LibPressio</h1>
<p>Here is a minimal example with error checking of how to use LibPressio:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;libpressio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sz.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// provides input function, found in ./test</span></div>
<div class="line"><span class="preprocessor">#include &quot;make_input_data.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// get a handle to a compressor</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio.html">pressio</a>* library = <a class="code" href="pressio_8h.html#ac4e98410700c79ad26806d58b48fa718">pressio_instance</a>();</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__compressor.html">pressio_compressor</a>* compressor = <a class="code" href="pressio_8h.html#a547c6d84cc54b3eef8d0267c6f317888">pressio_get_compressor</a>(library, <span class="stringliteral">&quot;sz&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// configure metrics</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* metrics[] = { <span class="stringliteral">&quot;size&quot;</span> };</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__metrics.html">pressio_metrics</a>* metrics_plugin =</div>
<div class="line">    <a class="code" href="pressio_8h.html#ac26b97dd74da0ceb63d6b5f256ce8da3">pressio_new_metrics</a>(library, metrics, 1);</div>
<div class="line">  <a class="code" href="pressio__compressor_8h.html#a3121c9e8f06460b7a52bde24b959c829">pressio_compressor_set_metrics</a>(compressor, metrics_plugin);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// configure the compressor</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__options.html">pressio_options</a>* sz_options =</div>
<div class="line">    <a class="code" href="pressio__compressor_8h.html#aa871896f165ec00d4bb4ff07c03d9403">pressio_compressor_get_options</a>(compressor);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="pressio__options_8h.html#a8fe2989a69c904934855f443d8154c05">pressio_options_set_integer</a>(sz_options, <span class="stringliteral">&quot;sz:error_bound_mode&quot;</span>, ABS);</div>
<div class="line">  <a class="code" href="pressio__options_8h.html#a792d1a0c54301df38255b08a15532052">pressio_options_set_double</a>(sz_options, <span class="stringliteral">&quot;sz:abs_err_bound&quot;</span>, 0.5);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="pressio__compressor_8h.html#a1fdd4e15abe46aa50f84849d81a2b9eb">pressio_compressor_check_options</a>(compressor, sz_options)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="pressio__compressor_8h.html#ac91e0f49fe7490bca34ff95d97182e65">pressio_compressor_error_msg</a>(compressor));</div>
<div class="line">    exit(<a class="code" href="pressio__compressor_8h.html#adcbea7b5644e9c8921e58df32cd9662f">pressio_compressor_error_code</a>(compressor));</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="pressio__compressor_8h.html#a6e12cd7f958aa91611fc3f242b0353f3">pressio_compressor_set_options</a>(compressor, sz_options)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="pressio__compressor_8h.html#ac91e0f49fe7490bca34ff95d97182e65">pressio_compressor_error_msg</a>(compressor));</div>
<div class="line">    exit(<a class="code" href="pressio__compressor_8h.html#adcbea7b5644e9c8921e58df32cd9662f">pressio_compressor_error_code</a>(compressor));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// load a 300x300x300 dataset into data created with malloc</span></div>
<div class="line">  <span class="keywordtype">double</span>* rawinput_data = make_input_data();</div>
<div class="line">  <span class="keywordtype">size_t</span> dims[] = { 300, 300, 300 };</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__data.html">pressio_data</a>* input_data =</div>
<div class="line">    <a class="code" href="pressio__data_8h.html#ac211997fe26d92c8a797ae657d1d4940">pressio_data_new_move</a>(<a class="code" href="pressio__dtype_8h.html#a06838f5680785d965f347017a79b10f7a1307b1ed406e56dbf2721b1f4966c0cf">pressio_double_dtype</a>, rawinput_data, 3, dims,</div>
<div class="line">                          <a class="code" href="pressio__data_8h.html#a87ce483c46d0fd8fc54e02b9debb219c">pressio_data_libc_free_fn</a>, NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// creates an output dataset pointer</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__data.html">pressio_data</a>* compressed_data =</div>
<div class="line">    <a class="code" href="pressio__data_8h.html#aa3e4e6d187fc99c65a7ea1a9e8e56656">pressio_data_new_empty</a>(<a class="code" href="pressio__dtype_8h.html#a06838f5680785d965f347017a79b10f7a0874be95fb4d4ffe55b162f39ddbef52">pressio_byte_dtype</a>, 0, NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// configure the decompressed output area</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__data.html">pressio_data</a>* decompressed_data =</div>
<div class="line">    <a class="code" href="pressio__data_8h.html#aa3e4e6d187fc99c65a7ea1a9e8e56656">pressio_data_new_empty</a>(<a class="code" href="pressio__dtype_8h.html#a06838f5680785d965f347017a79b10f7a1307b1ed406e56dbf2721b1f4966c0cf">pressio_double_dtype</a>, 3, dims);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// compress the data</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="pressio__compressor_8h.html#a3fdc547646a7cc0553fd2b67a100a890">pressio_compressor_compress</a>(compressor, input_data, compressed_data)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="pressio__compressor_8h.html#ac91e0f49fe7490bca34ff95d97182e65">pressio_compressor_error_msg</a>(compressor));</div>
<div class="line">    exit(<a class="code" href="pressio__compressor_8h.html#adcbea7b5644e9c8921e58df32cd9662f">pressio_compressor_error_code</a>(compressor));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// decompress the data</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="pressio__compressor_8h.html#a12d41b81e965db9c3895d4f67fa5f614">pressio_compressor_decompress</a>(compressor, compressed_data,</div>
<div class="line">                                    decompressed_data)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="pressio__compressor_8h.html#ac91e0f49fe7490bca34ff95d97182e65">pressio_compressor_error_msg</a>(compressor));</div>
<div class="line">    exit(<a class="code" href="pressio__compressor_8h.html#adcbea7b5644e9c8921e58df32cd9662f">pressio_compressor_error_code</a>(compressor));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get the compression ratio</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structpressio__options.html">pressio_options</a>* metric_results =</div>
<div class="line">    <a class="code" href="pressio__compressor_8h.html#ac450f375e263000e60c6e17d6d97f394">pressio_compressor_get_metrics_results</a>(compressor);</div>
<div class="line">  <span class="keywordtype">double</span> compression_ratio = 0;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="pressio__options_8h.html#a7f55152b8733ad57790146eb5906066d">pressio_options_get_double</a>(metric_results, <span class="stringliteral">&quot;size:compression_ratio&quot;</span>,</div>
<div class="line">                                 &amp;compression_ratio)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;failed to get compression ratio\n&quot;</span>);</div>
<div class="line">    exit(1);</div>
<div class="line">  }</div>
<div class="line">  printf(<span class="stringliteral">&quot;compression ratio: %lf\n&quot;</span>, compression_ratio);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// free the input, decompressed, and compressed data</span></div>
<div class="line">  <a class="code" href="pressio__data_8h.html#a31ff588300ebcb1af20eec3af221740a">pressio_data_free</a>(decompressed_data);</div>
<div class="line">  <a class="code" href="pressio__data_8h.html#a31ff588300ebcb1af20eec3af221740a">pressio_data_free</a>(compressed_data);</div>
<div class="line">  <a class="code" href="pressio__data_8h.html#a31ff588300ebcb1af20eec3af221740a">pressio_data_free</a>(input_data);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// free options and the library</span></div>
<div class="line">  <a class="code" href="pressio__options_8h.html#a62a350c16b85104a43790243105e7d67">pressio_options_free</a>(sz_options);</div>
<div class="line">  <a class="code" href="pressio__options_8h.html#a62a350c16b85104a43790243105e7d67">pressio_options_free</a>(metric_results);</div>
<div class="line">  <a class="code" href="pressio__compressor_8h.html#a02e079556262027593cb09e9646e9e20">pressio_compressor_release</a>(compressor);</div>
<div class="line">  <a class="code" href="pressio_8h.html#a02ac103c80c0a5c6ab366c45208c9ced">pressio_release</a>(library);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="apressio_8h_html_a02ac103c80c0a5c6ab366c45208c9ced"><div class="ttname"><a href="pressio_8h.html#a02ac103c80c0a5c6ab366c45208c9ced">pressio_release</a></div><div class="ttdeci">void pressio_release(struct pressio *library)</div></div>
<div class="ttc" id="apressio_8h_html_a547c6d84cc54b3eef8d0267c6f317888"><div class="ttname"><a href="pressio_8h.html#a547c6d84cc54b3eef8d0267c6f317888">pressio_get_compressor</a></div><div class="ttdeci">struct pressio_compressor * pressio_get_compressor(struct pressio *library, const char *compressor_id)</div></div>
<div class="ttc" id="apressio_8h_html_ac26b97dd74da0ceb63d6b5f256ce8da3"><div class="ttname"><a href="pressio_8h.html#ac26b97dd74da0ceb63d6b5f256ce8da3">pressio_new_metrics</a></div><div class="ttdeci">struct pressio_metrics * pressio_new_metrics(struct pressio *library, const char *const metrics[], int num_metrics)</div></div>
<div class="ttc" id="apressio_8h_html_ac4e98410700c79ad26806d58b48fa718"><div class="ttname"><a href="pressio_8h.html#ac4e98410700c79ad26806d58b48fa718">pressio_instance</a></div><div class="ttdeci">struct pressio * pressio_instance()</div></div>
<div class="ttc" id="apressio__compressor_8h_html_a02e079556262027593cb09e9646e9e20"><div class="ttname"><a href="pressio__compressor_8h.html#a02e079556262027593cb09e9646e9e20">pressio_compressor_release</a></div><div class="ttdeci">void pressio_compressor_release(struct pressio_compressor *compressor)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_a12d41b81e965db9c3895d4f67fa5f614"><div class="ttname"><a href="pressio__compressor_8h.html#a12d41b81e965db9c3895d4f67fa5f614">pressio_compressor_decompress</a></div><div class="ttdeci">int pressio_compressor_decompress(struct pressio_compressor *compressor, const struct pressio_data *input, struct pressio_data *output)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_a1fdd4e15abe46aa50f84849d81a2b9eb"><div class="ttname"><a href="pressio__compressor_8h.html#a1fdd4e15abe46aa50f84849d81a2b9eb">pressio_compressor_check_options</a></div><div class="ttdeci">int pressio_compressor_check_options(struct pressio_compressor *compressor, struct pressio_options const *options)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_a3121c9e8f06460b7a52bde24b959c829"><div class="ttname"><a href="pressio__compressor_8h.html#a3121c9e8f06460b7a52bde24b959c829">pressio_compressor_set_metrics</a></div><div class="ttdeci">void pressio_compressor_set_metrics(struct pressio_compressor *compressor, struct pressio_metrics *plugin)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_a3fdc547646a7cc0553fd2b67a100a890"><div class="ttname"><a href="pressio__compressor_8h.html#a3fdc547646a7cc0553fd2b67a100a890">pressio_compressor_compress</a></div><div class="ttdeci">int pressio_compressor_compress(struct pressio_compressor *compressor, const struct pressio_data *input, struct pressio_data *output)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_a6e12cd7f958aa91611fc3f242b0353f3"><div class="ttname"><a href="pressio__compressor_8h.html#a6e12cd7f958aa91611fc3f242b0353f3">pressio_compressor_set_options</a></div><div class="ttdeci">int pressio_compressor_set_options(struct pressio_compressor *compressor, struct pressio_options const *options)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_aa871896f165ec00d4bb4ff07c03d9403"><div class="ttname"><a href="pressio__compressor_8h.html#aa871896f165ec00d4bb4ff07c03d9403">pressio_compressor_get_options</a></div><div class="ttdeci">struct pressio_options * pressio_compressor_get_options(struct pressio_compressor const *compressor)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_ac450f375e263000e60c6e17d6d97f394"><div class="ttname"><a href="pressio__compressor_8h.html#ac450f375e263000e60c6e17d6d97f394">pressio_compressor_get_metrics_results</a></div><div class="ttdeci">struct pressio_options * pressio_compressor_get_metrics_results(struct pressio_compressor const *compressor)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_ac91e0f49fe7490bca34ff95d97182e65"><div class="ttname"><a href="pressio__compressor_8h.html#ac91e0f49fe7490bca34ff95d97182e65">pressio_compressor_error_msg</a></div><div class="ttdeci">const char * pressio_compressor_error_msg(struct pressio_compressor const *compressor)</div></div>
<div class="ttc" id="apressio__compressor_8h_html_adcbea7b5644e9c8921e58df32cd9662f"><div class="ttname"><a href="pressio__compressor_8h.html#adcbea7b5644e9c8921e58df32cd9662f">pressio_compressor_error_code</a></div><div class="ttdeci">int pressio_compressor_error_code(struct pressio_compressor const *compressor)</div></div>
<div class="ttc" id="apressio__data_8h_html_a31ff588300ebcb1af20eec3af221740a"><div class="ttname"><a href="pressio__data_8h.html#a31ff588300ebcb1af20eec3af221740a">pressio_data_free</a></div><div class="ttdeci">void pressio_data_free(struct pressio_data *data)</div></div>
<div class="ttc" id="apressio__data_8h_html_a87ce483c46d0fd8fc54e02b9debb219c"><div class="ttname"><a href="pressio__data_8h.html#a87ce483c46d0fd8fc54e02b9debb219c">pressio_data_libc_free_fn</a></div><div class="ttdeci">void pressio_data_libc_free_fn(void *data, void *metadata)</div></div>
<div class="ttc" id="apressio__data_8h_html_aa3e4e6d187fc99c65a7ea1a9e8e56656"><div class="ttname"><a href="pressio__data_8h.html#aa3e4e6d187fc99c65a7ea1a9e8e56656">pressio_data_new_empty</a></div><div class="ttdeci">struct pressio_data * pressio_data_new_empty(const enum pressio_dtype dtype, size_t const num_dimensions, size_t const dimensions[])</div></div>
<div class="ttc" id="apressio__data_8h_html_ac211997fe26d92c8a797ae657d1d4940"><div class="ttname"><a href="pressio__data_8h.html#ac211997fe26d92c8a797ae657d1d4940">pressio_data_new_move</a></div><div class="ttdeci">struct pressio_data * pressio_data_new_move(const enum pressio_dtype dtype, void *data, size_t const num_dimensions, size_t const dimensions[], pressio_data_delete_fn deleter, void *metadata)</div></div>
<div class="ttc" id="apressio__dtype_8h_html_a06838f5680785d965f347017a79b10f7a0874be95fb4d4ffe55b162f39ddbef52"><div class="ttname"><a href="pressio__dtype_8h.html#a06838f5680785d965f347017a79b10f7a0874be95fb4d4ffe55b162f39ddbef52">pressio_byte_dtype</a></div><div class="ttdeci">@ pressio_byte_dtype</div><div class="ttdef"><b>Definition:</b> pressio_dtype.h:27</div></div>
<div class="ttc" id="apressio__dtype_8h_html_a06838f5680785d965f347017a79b10f7a1307b1ed406e56dbf2721b1f4966c0cf"><div class="ttname"><a href="pressio__dtype_8h.html#a06838f5680785d965f347017a79b10f7a1307b1ed406e56dbf2721b1f4966c0cf">pressio_double_dtype</a></div><div class="ttdeci">@ pressio_double_dtype</div><div class="ttdef"><b>Definition:</b> pressio_dtype.h:17</div></div>
<div class="ttc" id="apressio__options_8h_html_a62a350c16b85104a43790243105e7d67"><div class="ttname"><a href="pressio__options_8h.html#a62a350c16b85104a43790243105e7d67">pressio_options_free</a></div><div class="ttdeci">void pressio_options_free(struct pressio_options *options)</div></div>
<div class="ttc" id="apressio__options_8h_html_a792d1a0c54301df38255b08a15532052"><div class="ttname"><a href="pressio__options_8h.html#a792d1a0c54301df38255b08a15532052">pressio_options_set_double</a></div><div class="ttdeci">void pressio_options_set_double(struct pressio_options *options, const char *key, double value)</div></div>
<div class="ttc" id="apressio__options_8h_html_a7f55152b8733ad57790146eb5906066d"><div class="ttname"><a href="pressio__options_8h.html#a7f55152b8733ad57790146eb5906066d">pressio_options_get_double</a></div><div class="ttdeci">enum pressio_options_key_status pressio_options_get_double(struct pressio_options const *options, const char *key, double *value)</div></div>
<div class="ttc" id="apressio__options_8h_html_a8fe2989a69c904934855f443d8154c05"><div class="ttname"><a href="pressio__options_8h.html#a8fe2989a69c904934855f443d8154c05">pressio_options_set_integer</a></div><div class="ttdeci">void pressio_options_set_integer(struct pressio_options *options, const char *key, int32_t value)</div></div>
<div class="ttc" id="astructpressio__compressor_html"><div class="ttname"><a href="structpressio__compressor.html">pressio_compressor</a></div><div class="ttdef"><b>Definition:</b> compressor.h:311</div></div>
<div class="ttc" id="astructpressio__data_html"><div class="ttname"><a href="structpressio__data.html">pressio_data</a></div><div class="ttdef"><b>Definition:</b> data.h:52</div></div>
<div class="ttc" id="astructpressio__metrics_html"><div class="ttname"><a href="structpressio__metrics.html">pressio_metrics</a></div><div class="ttdef"><b>Definition:</b> metrics.h:270</div></div>
<div class="ttc" id="astructpressio__options_html"><div class="ttname"><a href="structpressio__options.html">pressio_options</a></div><div class="ttdef"><b>Definition:</b> options.h:345</div></div>
<div class="ttc" id="astructpressio_html"><div class="ttname"><a href="structpressio.html">pressio</a></div><div class="ttdef"><b>Definition:</b> pressio.h:133</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
Getting Started</h1>
<p>After skimming the example, LibPressio has 6 major headers that you will need to use:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Use    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pressio.h</code>   </td><td class="markdownTableBodyNone">Error reporting and aquiring handles to compressors    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="pressio__compressor_8h.html" title="Compress, decompress, and configure pressio and lossless compressors.">pressio_compressor.h</a></code>   </td><td class="markdownTableBodyNone">Used to compress and decompress data, provided by plugins    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="pressio__data_8h.html" title="an abstraction for a contagious memory region of a specified type">pressio_data.h</a></code>   </td><td class="markdownTableBodyNone">Represents data and associated metadata (size, type, dimentionality, memory ownership)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="pressio__options_8h.html" title="A set of options for a compressor.">pressio_options.h</a></code>   </td><td class="markdownTableBodyNone">Maps between names and values, used for options for compressors and metrics results    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="pressio__metrics_8h.html" title="Metrics facilities to introspect compressor functions, input, and output.">pressio_metrics.h</a></code>   </td><td class="markdownTableBodyNone">A set of metrics to run while compressors run    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="pressio__io_8h.html" title="a generic io interface for libpressio">pressio_io.h</a></code>   </td><td class="markdownTableBodyNone">An extension header that provides methods to load or store data from/to persistent storage   </td></tr>
</table>
<p>All of these are included by the convience header <code>libpressio.h</code>.</p>
<p>You can pick up the more advanced features as you need them.</p>
<p>You can also find more examples in <code>test/</code></p>
<h1><a class="anchor" id="autotoc_md3"></a>
Supported Compressors and Metrics</h1>
<p>Libpressio provides a number of builtin compressor and metrics modules. All of these are disabled by default. They can be enabled by passing the corresponding <code>LIBPRESSIO_HAS_*</code> variable to CMake.</p>
<p>Additionally, Libpressio is extensible. For information on writing a compressor plugin see <a class="el" href="writingacompressor.html">Writing a Compressor Plugin</a> For information on writing a metrics plugin see <a class="el" href="writingametric.html">Writing a Metrics Plugin</a></p>
<h2><a class="anchor" id="autotoc_md4"></a>
Compressor Plugins</h2>
<p>See the <a class="el" href="compressors.html">compressor settings page</a> for information on how to configure them.</p>
<ul>
<li><code>sz</code> &ndash; the SZ error bounded lossy compressor</li>
<li><code>zfp</code> &ndash; the ZFP error bounded lossy compressor</li>
<li><code>mgard</code> &ndash; the MGARD error bounded lossy compressor</li>
<li><code>blosc</code> &ndash; the blosc lossless compressor</li>
<li><code>magick</code> &ndash; the ImageMagick image compression/decompression library</li>
<li><code>fpzip</code> &ndash; the fpzip floating point lossless compressor</li>
<li><code>noop</code> &ndash; a dummy compressor useful performance evaluation, testing, and introspection</li>
<li><code>sampling</code> &ndash; a compressor which does naive, with out replacement, and with replacement sampling</li>
<li><code>transpose</code> &ndash; a meta-compressor which performs a transpose.</li>
<li><code>resize</code> &ndash; a meta-compressor which preforms a reshape operation.</li>
<li><code>bit_grooming</code> a compressor which implements big grooming</li>
<li><code>digit_rounding</code> a compressor which implements digit_rounding</li>
<li><code>many_dependent</code> - a meta-compressor which runs many dependent tasks in parallel</li>
<li><code>many_independent</code> - a meta-compressor which runs many independent tasks in parallel</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
Metrics Plugins</h2>
<p>See the <a class="el" href="metrics.html">metrics results page</a> for information on what they produce</p>
<ul>
<li><code>time</code> &ndash; time information on each compressor API</li>
<li><code>error_stat</code> &ndash; statistics on the difference between the uncompressed and decompressed values that can be computed in one pass in linear time.</li>
<li><code>spatial_error</code> &ndash; computes relative spatial error</li>
<li><code>pearson</code> &ndash; computes the pearson coefficient of correlation and pearson coefficient of determination.</li>
<li><code>size</code> &ndash; information on the size of the compressed and decompressed data</li>
<li><code>ftk_critical_points</code> &ndash; an experimental metrics plugin which finds critical points using FTK</li>
<li><code>kl_divergance</code> &ndash; computes the kl divergence a metric used to evaluate ML/AI models</li>
<li><code>ks_test</code> &ndash; computes the p value and test statistic for a KS test</li>
<li><code>kth_error</code> &ndash; returns the kth largest value in the dataset</li>
<li><code>external</code> &ndash; run an external program to collect some metrics, see <a class="el" href="usingexternalmetric.html">using an external metric for more information</a></li>
<li><code>printer</code> &ndash; prints out the sequence of calls made to a libpressio compressor</li>
<li><code>spatial_error</code> &ndash; records the percentage of elements that exceed a configurable threshold</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Dependencies</h1>
<p>Libpressio unconditionally requires:</p>
<ul>
<li><code>cmake</code> version <code>3.13</code> or later (3.14 required for python bindings)</li>
<li><code>pkg-config</code> version <code>1.6.3</code> or later</li>
<li><a href="https://github.com/robertu94/std_compat"><code>std_compat</code></a> version 0.0.7 or later</li>
<li>either:<ul>
<li><code>gcc-4.8.5</code> or later</li>
<li><code>clang-7.0.0</code> or later using either <code>libc++</code> or <code>libstdc++</code>. Beware that system libraries may need to be recompiled with <code>libc++</code> if using <code>libc++</code></li>
</ul>
</li>
</ul>
<p>Libpressio additionally optionally requires:</p>
<ul>
<li><code>Doxygen</code> version 1.8.15 or later to generate documentation</li>
<li><code>HDF5</code> version 1.10.0 or later for HDF5 data support</li>
<li><code>ImageMagick</code> version 6.9.7 or later for ImageMagick image support. Version 7 or later supports additional data types.</li>
<li><code>biggroomingZ</code> version 2.1.9 or later for bit grooming support</li>
<li><code>blosc</code> version 1.14.2 for lossless compressor support via blosc</li>
<li><code>boost</code> version 1.53 to compile on a c++14 or earlier compiler</li>
<li><code>digitroundingZ</code> version 2.1.9 or later for digit rounding support</li>
<li><code>fpzip</code> version 1.3 for fpzip support</li>
<li><code>numpy</code> version <code>1.14.5</code> or later and its dependencies to provide the python bindings</li>
<li><code>swig</code> version 3.0.12 or later for python support</li>
<li><code>sz</code> commit <code>7b7463411f02be4700d13aac6737a6a9662806b4</code> or later and its dependencies to provide the SZ plugin</li>
<li><code>zfp</code> commit <code>e8edaced12f139ddf16167987ded15e5da1b98da</code> or later and its dependencies to provide the ZFP plugin</li>
<li><code>libdistributed</code> the latest version released at the time of a particular Libpressio release</li>
<li><code>python</code> 3.4 or later for the python bindings</li>
<li><code>lua</code> or <code>luajit</code> version 5.1 or later to provide custom composite metrics. NOTE compiling with Lua support requires c++17 or later (i.e. gcc 7 or later, and clang 3.9 or later; see Sol2 for current requirements).</li>
<li><code>sol2</code> version 3.2.0 or later to provide custom composite metrics</li>
<li><code>OpenMP</code> development libraries and headers for your compiler compatible with OpenMP Standard 3 or later to accelerate computation of some metrics.</li>
<li><code>MPI</code> development libraries and headers supporting MPI-2 (specifically MPI_Comm_spawn using the <code>workdir</code> info option) to provide the external metrics <code>mpispawn</code> launch method</li>
<li><code>mgard</code> we endevor to supprt the development version, but is known to work with commit <code>b67a0ac963587f190e106cc3c0b30773a9455f7a</code></li>
<li><code>PETSc</code> version 3.12.1 or later to provide PETSc binary format IO support</li>
</ul>
<p>It is also possible to build and run libpressio via Docker using the docker files in the <code>docker</code> directory. This functionality should be considered deprecated and will be removed in a later release, please you spack instead.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Installing LibPressio using Spack</h1>
<p>LibPressio can be built using <a href="https://github.com/spack/spack/">spack</a>. This example will install libpressio with only the SZ plugin.</p>
<div class="fragment"><div class="line">git clone https://github.com/robertu94/spack_packages robertu94_packages</div>
<div class="line">spack repo add robertu94_packages</div>
<div class="line">spack install libpressio+sz</div>
</div><!-- fragment --><p>You can see the other available versions by calling <code>spack info libpressio</code></p>
<h1><a class="anchor" id="autotoc_md8"></a>
Doing a development build with spack</h1>
<div class="fragment"><div class="line">#this is only required if it hasn&#39;t been done before</div>
<div class="line">git clone https://github.com/robertu94/spack_packages robertu94_packages</div>
<div class="line">spack repo add robertu94_packages</div>
<div class="line"> </div>
<div class="line">git clone https://github.com/robertu94/libpressio</div>
<div class="line">cd  libpressio</div>
<div class="line">#make sure it builds first</div>
<div class="line">spack dev-build libpressio@master</div>
<div class="line">#make your changes</div>
<div class="line">spack dev-build libpressio@master</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
Configuring LibPressio Manually</h1>
<p>LibPressio uses cmake to configure build options. See CMake documentation to see how to configure options</p>
<ul>
<li><code>CMAKE_INSTALL_PREFIX</code> - install the library to a local directory prefix</li>
<li><code>BUILD_DOCS</code> - build the project documentation</li>
<li><code>BUILD_TESTING</code> - build the test cases</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Building and Installing LibPressio</h1>
<p>To build and tests and install the library only.</p>
<div class="fragment"><div class="line">BUILD_DIR=build</div>
<div class="line">mkdir $BUILD_DIR</div>
<div class="line">cd $BUILD_DIR</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
<div class="line">make test</div>
<div class="line">make install</div>
</div><!-- fragment --><p>To build the documentation:</p>
<div class="fragment"><div class="line">BUILD_DIR=build</div>
<div class="line">mkdir $BUILD_DIR</div>
<div class="line">cd $BUILD_DIR</div>
<div class="line">cmake .. -DBUILD_DOCS=ON</div>
<div class="line">make docs</div>
<div class="line"># the html docs can be found in $BUILD_DIR/html/index.html</div>
<div class="line"># the man pages can be found in $BUILD_DIR/man/</div>
</div><!-- fragment --><p>To build on a C++11 compiler: (make sure boost is available)</p>
<div class="fragment"><div class="line">BUILD_DIR=build</div>
<div class="line">mkdir $BUILD_DIR</div>
<div class="line">cd $BUILD_DIR</div>
<div class="line">cmake -DLIBPRESSIO_CXX_VERSION=11 ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>To build the python bindings:</p>
<div class="fragment"><div class="line">BUILD_DIR=build</div>
<div class="line">mkdir $BUILD_DIR</div>
<div class="line">cd $BUILD_DIR</div>
<div class="line">cmake .. -DBUILD_PYTHON_WRAPPER=ON</div>
<div class="line">make</div>
<div class="line">make install</div>
</div><!-- fragment --><p>To disable building the test cases</p>
<div class="fragment"><div class="line">BUILD_DIR=build</div>
<div class="line">mkdir $BUILD_DIR</div>
<div class="line">cd $BUILD_DIR</div>
<div class="line">cmake .. -DBUILD_TESTING=OFF</div>
<div class="line">make</div>
<div class="line">ctest .</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11"></a>
Python</h1>
<p>LibPressio has a low level and high level set of python bindings. The low level bindings mirror the C interface as closely as possible. Where as the higher level bindings are based on <code>numcodecs</code> and may lack new or developing features from the C api, but are much more ergonomic and pythonic.</p>
<p>The recommended way to install them is with <code>spack install libpressio+python+mpi</code> in addition to enabling any variants for compressors such as <code>+sz+zfp</code> for SZ and ZFP.</p>
<p>Here is an example of how to use the high level bindings:</p>
<div class="fragment"><div class="line">#!/usr/bin/env python</div>
<div class="line">from pprint import pprint</div>
<div class="line">from pathlib import Path</div>
<div class="line">from libpressio import PressioCompressor</div>
<div class="line">import numpy as np</div>
<div class="line"> </div>
<div class="line">dataset_path = Path.home() / &quot;git/datasets/hurricane/100x500x500/CLOUDf48.bin.f32&quot;</div>
<div class="line">uncompressed_data = np.fromfile(dataset_path, dtype=np.float32)</div>
<div class="line">uncompressed_data = uncompressed_data.reshape(500, 500, 100)</div>
<div class="line">decompressed_data = uncompressed_data.copy()</div>
<div class="line"> </div>
<div class="line"># load and configure the compressor</div>
<div class="line">compressor = PressioCompressor.from_config({</div>
<div class="line">    &quot;compressor_id&quot;: &quot;sz&quot;,</div>
<div class="line">    &quot;compressor_config&quot;: {</div>
<div class="line">        &quot;sz:error_bound_mode_str&quot;: &quot;abs&quot;,</div>
<div class="line">        &quot;sz:abs_err_bound&quot;: 1e-6,</div>
<div class="line">        &quot;sz:metric&quot;: &quot;size&quot;</div>
<div class="line">        }</div>
<div class="line">    })</div>
<div class="line"> </div>
<div class="line"># print out some metadata</div>
<div class="line">print(compressor.codec_id)</div>
<div class="line">pprint(compressor.get_config())</div>
<div class="line">pprint(compressor.get_compile_config())</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># preform compression and decompression</div>
<div class="line">compressed = compressor.encode(uncompressed_data)</div>
<div class="line">decompressed = compressor.decode(compressed, decompressed_data)</div>
<div class="line"> </div>
<div class="line"># print out some metrics collected during compression</div>
<div class="line">pprint(compressor.get_metrics())</div>
</div><!-- fragment --><p>More documentation can be found in the doc-strings for the high level bindings.</p>
<h1><a class="anchor" id="autotoc_md12"></a>
Option Names</h1>
<p>LibPressio uses a key-value system to refer to configuration settings.</p>
<p>Each compressor may find specific configuration settings for its specific compressor with settings beginning with its compressor id as prefix (i.e. configurations for SZ begin with <code>sz:</code>). <a class="el" href="compressors.html">Refer to the specific compressors documentation</a> for further documentation for each settings.</p>
<p>The prefixes <code>metrics:</code> and <code>pressio:</code> are reserved for future use.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Stability</h1>
<p>As of version 1.0.0, LibPressio will follow the following API stability guidelines:</p>
<ul>
<li>The functions defined in files in <code>./include</code> excluding files in the <code>./include/libpressio_ext/</code> or its subdirectories may be considered to be stable. Furthermore, all files in this set are C compatible.</li>
<li>The functions defined in files in <code>./include/libpressio_ext/</code> are to be considered unstable.</li>
<li>The functions and modules defined in the low-level python bindings are stable (import <code>pressio</code>).</li>
<li>The functions and modules defined in the higher-level python bindings are unstable (import <code>libpressio</code>).</li>
<li>Any functions listed above, in <code>docs/MetricResults.md</code> or in <code>docs/MetricResults.md</code> as experimental are unstable</li>
<li>Any configurable that has a key <code>pressio:stability</code> with a value of <code>experimental</code> or <code>unstable</code> are unstable. Modules that are experimental may crash or have other severe deficiencies, modules that are unstable generally will not crash, but may have options changed according to the unstable API guarantees.</li>
<li>Any configurable that has a key <code>pressio:stability</code> with a value of <code>stable</code> conforms to the LibPressio stability guarantees</li>
<li>Any configurable that has the key <code>pressio:stability</code> with a value of <code>external</code> indicates that options/configuration returned by this module are controlled by version of the external library that it depends upon and may change at any time without changing the LibPressio version number.</li>
</ul>
<p>Stable means:</p>
<ul>
<li>New APIs may be introduced with the increase of the minor version number.</li>
<li>APIs may gain additional overloads for C++ compatible interfaces with an increase in the minor version number.</li>
<li>An API may change the number or type of parameters with an increase in the major version number.</li>
<li>An API may be removed with the change of the major version number</li>
<li>New options/configuration names may appear with a increase in the minor version number</li>
<li>Existing options/configuration names may be removed or changed with an increase in the major version number</li>
</ul>
<p>Unstable means:</p>
<ul>
<li>The API or options/configuration may change for any reason with the increase of the minor version number</li>
</ul>
<p>Additionally, the performance of functions, memory usage patterns may change for both stable and unstable code with the increase of the patch version.</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Code Contribution</h1>
<p>Please refer to <a class="el" href="md_CONTRIBUTORS.html">CONTRIBUTORS.md</a>.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Bug Reports</h1>
<p>Please files bugs to the Github Issues page on the CODARCode libpressio repository.</p>
<p>Please read this post on <a href="https://codingnest.com/how-to-file-a-good-bug-report/">how to file a good bug report</a>.&#160; After reading this post, please provide the following information specific to libpressio:</p>
<ul>
<li>Your OS version and distribution information, usually this can be found in <code>/etc/os-release</code></li>
<li>the output of <code>cmake -L $BUILD_DIR</code></li>
<li>the version of each of libpressio's dependencies listed in the README that you have installed. Where possible, please provide the commit hashes. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
